<?php

namespace Database\Seeders;

use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;
use App\Models\CareerTest;
use App\Models\CareerQuestion;
use App\Models\CareerTestResult;
use Illuminate\Support\Facades\Schema;

class CareerTestSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        // Очищаем старые данные
        Schema::disableForeignKeyConstraints();
        CareerTestResult::truncate();
        CareerQuestion::truncate();
        CareerTest::truncate();
        Schema::enableForeignKeyConstraints();

        // Создаем профориентационный тест
        $careerTest = CareerTest::create([
            'title' => 'Профориентационный тест (Visual Mind)',
            'description' => 'Комплексный тест для определения профессиональных склонностей и особенностей. Пожалуйста, отвечайте честно и подробно.',
            'is_active' => true,
            'time_limit' => 120 // Увеличим время, так как много текстовых вопросов
        ]);

        $questionsData = [
            // Общая информация
            ['text' => 'Укажите ваш возраст и текущий уровень образования.', 'type' => 'text', 'category' => 'Общая информация'],
            ['text' => 'Опишите особенности здоровья, которые могут влиять на работу или учёбу.', 'type' => 'text', 'category' => 'Здоровье'],
            ['text' => 'Есть ли у вас опыт трудовой деятельности (включая фриланс/волонтёрство/стажировки)?', 'type' => 'text', 'category' => 'Опыт'],
            
            // Самостоятельность и режим
            ['text' => 'Насколько вы самостоятельны в повседневной жизни?', 'type' => 'scale', 'category' => 'Самостоятельность'],
            ['text' => 'Какой режим дня для вас наиболее комфортен?', 'type' => 'text', 'category' => 'Режим'],
            ['text' => 'Как вы ощущаете свою готовность к работе в текущем состоянии жизни и здоровья?', 'type' => 'scale', 'category' => 'Мотивация'],
            ['text' => 'Что для вас наиболее важно в будущей профессиональной деятельности?', 'type' => 'text', 'category' => 'Мотивация'],
            
            // Условия работы и доступность
            ['text' => 'Какие способы работы с компьютером вам наиболее удобны?', 'type' => 'text', 'category' => 'Доступность'],
            ['text' => 'Как ваше самочувствие обычно меняется в течение рабочего дня?', 'type' => 'multiple_choice', 'options' => ['Стабильно на протяжении дня', 'Устаю к середине дня', 'Работаю рывками (волнами энергии)', 'Сильно зависит от дня', 'Трудно предсказать'], 'category' => 'Здоровье'],
            ['text' => 'Какие форматы коммуникации для вас наиболее доступны и комфортны?', 'type' => 'text', 'category' => 'Коммуникация'],
            ['text' => 'Насколько вам доступна самостоятельная мобильность и передвижение вне дома?', 'type' => 'scale', 'category' => 'Доступность'],
            ['text' => 'Требуются ли вам специальные условия рабочего места или оборудования?', 'type' => 'text', 'category' => 'Доступность'],
            ['text' => 'Влияет ли ваше состояние здоровья на скорость выполнения задач? Если скорость ниже — это скорее физическое, когнитивное или эмоциональное ограничение?', 'type' => 'text', 'category' => 'Здоровье'],
            ['text' => 'Нужно ли учитывать медицинские процедуры/лечение при планировании рабочего графика?', 'type' => 'text', 'category' => 'Здоровье'],
            ['text' => 'Какой формат работы для вас оптимален (удалённо/гибрид/офис)?', 'type' => 'multiple_choice', 'options' => ['Удалённо', 'Гибрид', 'Офис'], 'category' => 'Условия'],
            
            // Софт-скиллы и коммуникация
            ['text' => 'Как вы чувствуете себя при общении с новыми людьми?', 'type' => 'text', 'category' => 'Коммуникация'],
            ['text' => 'Какой стиль работы в команде вам ближе?', 'type' => 'text', 'category' => 'Команда'],
            ['text' => 'Насколько легко вам объяснять свои идеи другим людям?', 'type' => 'scale', 'category' => 'Коммуникация'],
            ['text' => 'Как вы реагируете на конструктивную критику?', 'type' => 'text', 'category' => 'Личность'],
            ['text' => 'Насколько вам комфортно быть на виду (презентации/выступления в доступном формате)?', 'type' => 'scale', 'category' => 'Коммуникация'],
            ['text' => 'Насколько вам легко находить компромиссы в спорных ситуациях?', 'type' => 'scale', 'category' => 'Коммуникация'],
            ['text' => 'Какую роль вы чаще всего играете в групповых проектах?', 'type' => 'text', 'category' => 'Команда'],
            
            // Обучение и мышление
            ['text' => 'Как вам удобнее всего изучать новую информацию?', 'type' => 'text', 'category' => 'Обучение'],
            ['text' => 'Насколько легко вам удерживать внимание на одной задаче длительное время?', 'type' => 'scale', 'category' => 'Внимание'],
            ['text' => 'Как вы относитесь к многозадачности?', 'type' => 'text', 'category' => 'Внимание'],
            ['text' => 'Какой тип мышления вам ближе?', 'type' => 'multiple_choice', 'options' => ['Логический', 'Творческий', 'Практический', 'Стратегический', 'Интуитивный'], 'category' => 'Мышление'],
            ['text' => 'Как вы обычно подходите к решению сложных проблем?', 'type' => 'text', 'category' => 'Мышление'],
            ['text' => 'Насколько быстро вы обучаетесь новым навыкам?', 'type' => 'scale', 'category' => 'Обучение'],
            ['text' => 'Что вас больше всего мотивирует в процессе обучения?', 'type' => 'text', 'category' => 'Мотивация'],
            
            // Технические навыки
            ['text' => 'Оцените свой уровень владения компьютером и цифровыми технологиями.', 'type' => 'scale', 'category' => 'Навыки'],
            ['text' => 'Какие программы и приложения вы используете регулярно?', 'type' => 'text', 'category' => 'Навыки'],
            ['text' => 'Есть ли у вас опыт программирования или интерес к его освоению?', 'type' => 'text', 'category' => 'Навыки'],
            ['text' => 'Насколько быстро вы осваиваете новые технологии и программы?', 'type' => 'scale', 'category' => 'Навыки'],
            ['text' => 'Используете ли вы адаптивные (ассистивные) технологии? Если да — какие?', 'type' => 'text', 'category' => 'Навыки'],
            ['text' => 'Хотели бы вы углубить технические знания? В каких областях?', 'type' => 'text', 'category' => 'Навыки'],
            
            // Интересы и предпочтения
            ['text' => 'Если бы вы могли создать или реализовать любой проект без ограничений — что бы это было?', 'type' => 'text', 'category' => 'Интересы'],
            ['text' => 'Какие темы или области вы изучаете в свободное время?', 'type' => 'text', 'category' => 'Интересы'],
            ['text' => 'Что приносит вам наибольшее удовлетворение в работе/учёбе?', 'type' => 'text', 'category' => 'Интересы'],
            ['text' => 'Какие виды деятельности вас привлекают больше всего?', 'type' => 'text', 'category' => 'Интересы'],
            ['text' => 'Как вы относитесь к рутинным задачам?', 'type' => 'text', 'category' => 'Личность'],
            ['text' => 'Что вас сильнее всего мотивирует в работе (расставьте приоритеты)?', 'type' => 'text', 'category' => 'Мотивация'],
            ['text' => 'Опишите ваш идеальный рабочий день.', 'type' => 'text', 'category' => 'Предпочтения'],
            ['text' => 'Есть ли люди или карьерные пути, которые вас вдохновляют?', 'type' => 'text', 'category' => 'Интересы'],
            
            // Личность
            ['text' => 'Какими тремя главными качествами вы бы описали себя?', 'type' => 'text', 'category' => 'Личность'],
            ['text' => 'Вы скорее интроверт или экстраверт?', 'type' => 'multiple_choice', 'options' => ['Интроверт', 'Экстраверт'], 'category' => 'Личность'],
            ['text' => 'Насколько вы организованный человек?', 'type' => 'scale', 'category' => 'Личность'],
            ['text' => 'Как вы справляетесь со стрессом и давлением?', 'type' => 'text', 'category' => 'Личность'],
            ['text' => 'Насколько вы инициативны?', 'type' => 'scale', 'category' => 'Личность'],
            ['text' => 'Как вы относитесь к изменениям?', 'type' => 'text', 'category' => 'Личность'],
            ['text' => 'Можете ли вы эффективно работать самостоятельно без постоянного контроля?', 'type' => 'text', 'category' => 'Самостоятельность'],
            
            // Цели и барьеры
            ['text' => 'Какие у вас профессиональные цели на ближайшие 2–3 года?', 'type' => 'text', 'category' => 'Цели'],
            ['text' => 'С какими основными барьерами вы сталкиваетесь при поиске работы или обучении?', 'type' => 'text', 'category' => 'Барьеры'],
            ['text' => 'Есть ли у вас поддержка в профессиональном развитии? От кого?', 'type' => 'text', 'category' => 'Поддержка'],
            ['text' => 'Готовы ли вы к дополнительному обучению? Какой формат вам удобен?', 'type' => 'text', 'category' => 'Обучение'],
            ['text' => 'Что вы хотите, чтобы ИИ-ассистент обязательно учёл при составлении рекомендаций?', 'type' => 'text', 'category' => 'ИИ'],
            
            // Энергия, стресс и устойчивость (НОВЫЙ БЛОК)
            ['text' => 'Как часто вы чувствуете сильную усталость или истощение?', 'type' => 'multiple_choice', 'options' => ['Почти каждый день', 'Несколько раз в неделю', 'Редко', 'Зависит от нагрузки', 'Затрудняюсь ответить'], 'category' => 'Энергия'],
            ['text' => 'Что быстрее всего приводит вас к переутомлению?', 'type' => 'multiple_choice', 'options' => ['Физическая нагрузка', 'Длительное общение', 'Шум и сенсорная перегрузка', 'Эмоциональное давление', 'Дедлайны и контроль', 'Монотонность', 'Другое'], 'category' => 'Энергия'],
            ['text' => 'Что помогает вам восстанавливаться?', 'type' => 'multiple_choice', 'options' => ['Отдых в одиночестве', 'Смена деятельности', 'Сон', 'Поддержка людей', 'Физическая активность', 'Трудно восстанавливаться'], 'category' => 'Энергия'],
            
            // Границы и «красные флаги» (НОВЫЙ БЛОК)
            ['text' => 'Какие условия работы для вас НЕПРИЕМЛЕМЫ? (можно выбрать несколько, напишите через запятую если "Другое")', 'type' => 'multiple_choice', 'options' => ['Строгий график без гибкости', 'Постоянные звонки и общение', 'Физическая нагрузка', 'Высокая скорость и давление', 'Неопределённость задач', 'Публичность', 'Конкуренция', 'Другое'], 'category' => 'Границы'],
            ['text' => 'После какого типа работы вы чувствуете себя хуже, чем до неё?', 'type' => 'text', 'category' => 'Границы'],
            
            // Ответственность и формат задач (НОВЫЙ БЛОК)
            ['text' => 'Какой уровень ответственности вам комфортен?', 'type' => 'multiple_choice', 'options' => ['Небольшие, чёткие задачи', 'Самостоятельные задачи', 'Ответственность за результат', 'Ответственность за людей', 'Пока не знаю'], 'category' => 'Ответственность'],
            ['text' => 'Вам важнее:', 'type' => 'multiple_choice', 'options' => ['Стабильность', 'Свобода', 'Понятность', 'Возможность влиять', 'Минимальный стресс'], 'category' => 'Ответственность'],
            
            // Самовосприятие и идентичность (НОВЫЙ БЛОК)
            ['text' => 'Как вы сами воспринимаете свою инвалидность?', 'type' => 'multiple_choice', 'options' => ['Как серьёзное ограничение', 'Как особенность, с которой можно жить', 'Как часть идентичности', 'Стараюсь не думать об этом', 'По-разному'], 'category' => 'Самовосприятие'],
            ['text' => 'Насколько для вас важно, чтобы работодатель понимал и принимал ваши особенности?', 'type' => 'multiple_choice', 'options' => ['Крайне важно', 'Желательно', 'Не принципиально', 'Не хочу это обсуждать'], 'category' => 'Самовосприятие'],
            ['text' => 'Что для вас важнее всего, чтобы чувствовать себя уверенно на работе?', 'type' => 'text', 'category' => 'Самовосприятие'],
            
            // Финальные вопросы
            ['text' => 'Если бы идеальная работа СУЩЕСТВОВАЛА, что в ней точно было бы?', 'type' => 'text', 'category' => 'Идеал'],
            ['text' => 'И что в ней точно НИКОГДА не должно быть?', 'type' => 'text', 'category' => 'Идеал']
        ];

        $scaleOptions = ['0 — минимум/нет', '1 — ниже среднего', '2 — средне', '3 — выше среднего', '4 — максимум/да'];
        $order = 1;

        foreach ($questionsData as $data) {
            $options = [];
            if ($data['type'] === 'scale') {
                $options = $scaleOptions;
            } elseif ($data['type'] === 'multiple_choice' && isset($data['options'])) {
                $options = $data['options'];
            }

            CareerQuestion::create([
                'career_test_id' => $careerTest->id,
                'question_text' => $data['text'],
                'question_type' => $data['type'],
                'options' => $options,
                'category' => $data['category'],
                'order' => $order++,
                'is_required' => true
            ]);
        }
    }
}
